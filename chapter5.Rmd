# **Assignment 5: Dimensionality Reduction Techniques**

In order to see how Principal Component Analysis works, a dataset of parameters describing living conditions in different countries is studied. The variables include maternal mortality (Mat.Mor), life expectancy (Life.Exp), expected years of education (Edu.Exp) adolescent birth rate (ado.Birth), gross national income (GNI), ratio of labor force participation of females and males (Labo.FM), ratio of female and male populations with secondary education (Edu2.FM) and ration of female representatives in parliament (Parli.F). The dataset is combined from two sources. More information can be found from http://hdr.undp.org/en/content/human-development-index-hdi . 

```{r include=FALSE}
# access needed packages
library(MASS); library(tidyr); library(corrplot); library(dplyr)
library(ggplot2); library(GGally)
```

```{r}
# read the data set and check the structure
human = read.csv("data/human.csv")
summary(human)
```
As can be seen from the figure below, many of the variables are skewed. The skewedness is negative for F/M -ratio in secondary education and labor force as well as life expectancy. This means that although in many countries the ratios and life expectancy are rather high, the mean is lowered by a few countries having very low ratios or life expectancy. The skewedness is also quite natural as both, the ratio and life expectancy have a rather set upper limit that cannot be exceeded. The distribution of female representatives in parliament is positively skewed, meaning that it is more typical for countries to have parliament where majority of representatives are men and the parliaments with female majority are rarities. Gross national income, maternal mortality and adolescent birth rate have strong positively skewed distributions. Expected years of education has the only nearly normal distribution.

```{r}
# visualize the data
ggpairs(human[-1], lower = list(combo = wrap("facethist", bins = 20)))

```

The correlations between variables are better seen in the correlation matrix below. Education and gross national income seem to increase life expectancy. In the countries where maternal mortality and adolescent birth rate are high, the life expectancy is lower. These two also correlate positively, meaning that where adolescent birth rate is high, also maternal mortality is more common. High adolescent birth rates and maternal mortality seems to also go together with low education and gross national income. Quite interestingly, the ration in labor force and parliament do not seem to correlate strongly with any of the other variables.

```{r}
# compute the correlation matrix and visualize it with corrplot
cor(human[-1]) %>% corrplot
```

Next, in order to analyse the dependencies further, I perform Principal Component Analysis on the non-standardized dataset. It is already seen in the warning messages when plotting that there is a large difference in the variances of the variables. This leads typically to one variable with the largest variance to dominate.

```{r}
# perform principal component analysis (with the SVD method)
pca_human <- prcomp(human[-1])

# draw a biplot of the principal component representation and the original variables
biplot(pca_human, choices = 1:2, cex = c(0.8, 1), col =  c("grey40", "deeppink2"))

# print out a summary of pca_human
summary(pca_human)
```

It is better to do the PCA with standardized data and now the visualization is nicely centered around zero as seen below.

```{r}

# standardize the variables
human_std <- scale(human[-1])

# perform principal component analysis (with the SVD method)
pca_human_std <- prcomp(human_std)

# draw a biplot of the principal component representation and the original variables
biplot(pca_human_std, choices = 1:2, cex = c(0.8, 1), col =  c("grey40", "deeppink2"))

# print out a summary of pca_human_std
summary(pca_human_std)
```

Unfortunately there was some problems with dependencies with my version of R and the FactoMineR package and I was not able to install the package. I was too lazy and had too little time to solve this problem. Here are the code snippets though, copy-pasted from DataCamp. Unfortunately the DataCamp visualization did not work either, so I am not able to analyze the data.

```{r eval=FALSE, include=FALSE}
library(FactoMineR)

# column names to keep in the dataset
keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch")

# select the 'keep_columns' to create a new dataset
tea_time <- select(tea, one_of(keep_columns))

# visualize the dataset
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))

# multiple correspondence analysis
mca <- MCA(tea_time, graph = FALSE)

# summary of the model
summary(mca)

# visualize MCA
plot(mca, invisible=c("ind"), habillage = "quali", graph.type = "classic")
```
